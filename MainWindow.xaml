<Window x:Class="DirectoryAnalyzer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:services="clr-namespace:DirectoryAnalyzer.Services"
        Title="Directory Analyzer"
        Height="720" Width="1100"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="260"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Menu Lateral -->
            <Border Grid.Column="0" Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="0,0,1,0">
                <StackPanel Margin="18,26">
                    <TextBlock Text="Directory Analyzer"
                               Style="{StaticResource TitleTextStyle}"
                               Margin="0,0,0,4"/>
                    <TextBlock Text="Análise corporativa read-only"
                               Style="{StaticResource SubtitleTextStyle}"
                               Margin="0,0,0,18"/>
                    <ListBox x:Name="NavigationMenu"
                             SelectedIndex="0">
                        <ListBoxItem Tag="Dashboard">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Dashboard"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE80F;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Dashboard" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem IsHitTestVisible="False" Focusable="False">
                            <TextBlock Text="INFRAESTRUTURA" Style="{StaticResource NavSectionTextStyle}"/>
                        </ListBoxItem>
                        <ListBoxItem Tag="DNS Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="DNS Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE774;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="DNS Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="SMB Shares Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="SMB Shares Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE8B7;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="SMB Shares Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="Scheduled Tasks Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Scheduled Tasks Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE823;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Scheduled Tasks Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="IIS AppPools Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="IIS AppPools Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE7F8;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="IIS AppPools Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>

                        <ListBoxItem IsHitTestVisible="False" Focusable="False">
                            <TextBlock Text="SEGURANÇA" Style="{StaticResource NavSectionTextStyle}"/>
                        </ListBoxItem>
                        <ListBoxItem Tag="Local Security Policy Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Local Security Policy Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE72E;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Local Security Policy Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="Trusts Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Trusts Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE8D7;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Trusts Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>

                        <ListBoxItem IsHitTestVisible="False" Focusable="False">
                            <TextBlock Text="IDENTIDADE" Style="{StaticResource NavSectionTextStyle}"/>
                        </ListBoxItem>
                        <ListBoxItem Tag="GPO Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="GPO Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE716;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="GPO Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="Local Profiles Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Local Profiles Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE77B;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Local Profiles Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                        <ListBoxItem Tag="Service Account Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="Service Account Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE9D9;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="Service Account Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>

                        <ListBoxItem IsHitTestVisible="False" Focusable="False">
                            <TextBlock Text="MENSAGERIA" Style="{StaticResource NavSectionTextStyle}"/>
                        </ListBoxItem>
                        <ListBoxItem Tag="ProxyAddresses Analyzer">
                            <ListBoxItem.InputBindings>
                                <MouseBinding MouseAction="LeftClick"
                                              Command="{Binding DataContext.NavigateCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                                              CommandParameter="ProxyAddresses Analyzer"/>
                            </ListBoxItem.InputBindings>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="&#xE715;" Style="{StaticResource NavIconStyle}"
                                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ListBoxItem}}"/>
                                <TextBlock Text="ProxyAddresses Analyzer" VerticalAlignment="Center"/>
                            </StackPanel>
                        </ListBoxItem>
                    </ListBox>
                </StackPanel>
            </Border>

            <!-- Conteúdo Principal -->
            <Grid Grid.Column="1" Margin="26">
                <ContentControl x:Name="ContentArea"
                                Content="{Binding CurrentView}"/>
            </Grid>
        </Grid>

        <!-- Status bar -->
        <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1,0,0,0">
            <DockPanel Margin="24,10">
                <TextBlock Text="{Binding StatusMessage, Source={x:Static services:StatusService.Instance}}"
                           Style="{StaticResource CaptionTextStyle}"/>
            </DockPanel>
        </Border>
    </Grid>
</Window>
