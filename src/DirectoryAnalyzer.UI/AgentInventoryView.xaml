<UserControl x:Class="DirectoryAnalyzer.Views.AgentInventoryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource BackgroundBrush}">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </UserControl.Resources>
    <Grid Margin="0">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <Border Grid.Row="0" Style="{StaticResource CardStyle}">
            <DockPanel LastChildFill="False">
                <StackPanel>
                    <TextBlock Text="Agent Inventory" Style="{StaticResource TitleTextStyle}"/>
                    <TextBlock Text="Consulta usuÃ¡rios via agente mTLS." Style="{StaticResource SubtitleTextStyle}" Margin="0,6,0,0"/>
                </StackPanel>
                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" HorizontalAlignment="Right">
                    <Button Content="Executar" Style="{StaticResource PrimaryButtonStyle}" Command="{Binding RunCommand}"/>
                    <Button Content="Cancelar" Style="{StaticResource DangerButtonStyle}" Command="{Binding CancelCommand}" Margin="10,0,0,0"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <StackPanel Grid.Row="1" Margin="2,10,0,0">
            <ProgressBar IsIndeterminate="True"
                         Style="{StaticResource InlineProgressBarStyle}"
                         Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <TextBlock Text="{Binding ProgressMessage}"
                       Style="{StaticResource CaptionTextStyle}"
                       Foreground="{StaticResource PrimaryBrush}"
                       Visibility="{Binding IsBusy, Converter={StaticResource BooleanToVisibilityConverter}}"
                       Margin="0,8,0,0"/>
        </StackPanel>

        <Border Grid.Row="2" Style="{StaticResource CardStyle}" Margin="0,16,0,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <DataGrid AutoGenerateColumns="False" ItemsSource="{Binding Users}" Grid.Row="0">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="SamAccountName" Binding="{Binding SamAccountName}" Width="*"/>
                        <DataGridTextColumn Header="DisplayName" Binding="{Binding DisplayName}" Width="2*"/>
                        <DataGridCheckBoxColumn Header="Enabled" Binding="{Binding Enabled}" Width="Auto"/>
                    </DataGrid.Columns>
                </DataGrid>

                <Border Grid.Row="1"
                        Style="{StaticResource StatusChipStyle}"
                        Background="{StaticResource SuccessTintBrush}"
                        BorderBrush="{StaticResource SuccessBrush}"
                        Margin="0,12,0,0">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="&#xE930;" FontFamily="Segoe MDL2 Assets" Foreground="{StaticResource SuccessBrush}" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding StatusMessage}"
                                   Style="{StaticResource StatusChipTextStyle}"
                                   Foreground="{StaticResource SuccessBrush}"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
    </Grid>
</UserControl>
